import os


CODALAB_HOME = os.path.expanduser('~/.codalab')


class IntegrityError(Exception):
  '''
  Raised by the model when there is a database integrity issue.

  Indicates a serious error that either means that there was a bug in the model
  code that left the database in a bad state, or that there was an out-of-band
  database edit with the same result.
  '''


class PreconditionViolation(Exception):
  '''
  Raised when a value generated by one module fails to satisfy a precondition
  required by another module.

  This class of error is serious and should indicate a problem in code, but it
  it is not an AssertionError because it is not local to a single module.
  '''


class State(object):
  '''
  An enumeration of states that a bundle can be in.
  '''
  CREATED = 'created'
  BLOCKING = 'blocking'
  STAGED = 'staged'
  RUNNING = 'running'
  READY = 'ready'
  FAILED = 'failed'

  OPTIONS = set([CREATED, BLOCKING, STAGED, RUNNING, READY, FAILED])
  FINAL_STATES = set([READY, FAILED])


def precondition(condition, message):
  if not condition:
    raise PreconditionViolation(message)
